<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Monitor de Unidades - Cubicaje (Ãºnico archivo)</title>
  <style>
    :root{--bg:#f7fafc;--card:#fff;--muted:#6b7280;--ok:#16a34a;--warn:#f59e0b;--grey:#9ca3af}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:#111;position:relative;min-height:100vh}

    /* Imagen de fondo en capa baja (visibilidad atenuada + movimiento suave) */
    body::before{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;background-image:url('https://www.romacarabs.com/wp-content/uploads/2024/05/Llantas-de-un-coche.jpg');background-size:cover;background-position:45% 50%;background-repeat:no-repeat;opacity:0.55;filter:brightness(0.85) contrast(1.05) saturate(1.0);transform:scale(1);animation:bgPan 24s ease-in-out infinite}

    @keyframes bgPan{
      0%{transform:scale(1);background-position:40% 50%}
      50%{transform:scale(1.03);background-position:60% 50%}
      100%{transform:scale(1);background-position:40% 50%}
    }

    /* Header en verde claro para buena legibilidad */
    header{background:#2fa86e;color:#fff;padding:1rem 1rem;display:flex;align-items:center;justify-content:space-between;position:relative;z-index:3;box-shadow:0 2px 6px rgba(0,0,0,0.12)}
    header h1{margin:0;font-size:1.1rem;color:#000;font-weight:700}
    #today{color:#000}
    .controls{display:flex;gap:.5rem;align-items:center}
    input,select,button{padding:.45rem .6rem;border-radius:.375rem;border:1px solid #d1d5db}
    button{background:#111827;color:#fff;border:none}
    main{padding:1rem}
    .status{margin-bottom:1rem;color:var(--muted)}

    /* Make table text darker and headers stronger for better contrast */
    table{width:100%;border-collapse:collapse;background:transparent}
    th,td{padding:.6rem .75rem;border-bottom:1px solid #eef2f7;text-align:left;font-size:.95rem;color:#0b1220}
    th{background:#ffffff;color:#0b1220;font-weight:700}

    td.small{width:110px}
    .state{font-weight:600}
    .state.confirmed{color:var(--ok)}
    .state.pending{color:var(--warn)}
    .state.available{color:var(--grey)}
    .legend{margin-top:.5rem;color:var(--muted);font-size:.9rem}
    details .desc-list{margin:0.4rem 0 0 0;padding-left:1.05rem;max-height:160px;overflow:auto;font-size:.9rem;color:#111}
    details summary{cursor:pointer;font-weight:600;list-style:none}
    details summary::marker{display:none}
    details summary::after{content:'â–¾';float:right;font-weight:700}
    details[open] summary::after{content:'â–´'}
    /* Branding in header */
    .brand{font-weight:700;display:inline-flex;align-items:center;gap:12px;color:#000}
    .brand-logo{height:48px; width:auto; opacity:0.95; display:block; object-fit:contain}
@media(min-width:900px){ .brand-logo{height:64px} }
    .status-msg{font-size:0.85rem;color:var(--muted); margin-left:.6rem}

    /* Card that wraps the table to keep content readable over background */
    .card{background:rgba(255,255,255,1);padding:1rem;border-radius:12px; box-shadow:0 10px 30px rgba(15,23,42,0.18);position:relative;z-index:4;margin:1rem 0;border:1px solid rgba(0,0,0,0.04)}
    .table-wrap{overflow:auto}

    footer{padding:1rem;color:var(--muted);font-size:.85rem} 
    @media (max-width:800px){table,thead,tbody,th,td,tr{display:block}thead{display:none}td{border:none;border-bottom:1px solid #eee;padding:.6rem}td::before{content:attr(data-label);font-weight:600;display:block;margin-bottom:.3rem}}
  </style>
</head>
<body>
  <header>
    <h1>Estatus de las unidades <span id="today" style="font-weight:600;font-size:0.95rem;margin-left:.6rem;color:#cbd5e1"></span></h1>
    <div class="controls">
      <div id="status" class="status">Cargando datos...</div>
    </div>
  </header>

  <main>

    <div class="card">
      <div class="table-wrap">
        <table id="units" class="units">
          <thead>
            <tr>
              <th>Unidad</th>
              <th>EconÃ³mico</th>
              <th>Nombre</th>
              <th>Llantas</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </main>

  
  <script>
    // Normaliza nombres de campos para buscar valores independientemente de acentos/espacios
    const norm = k => (k||'').toString().trim().toLowerCase().replace(/\s+/g,'_').replace(/[()]/g,'').replace(/[^a-z0-9_]/g,'');

    function getField(obj, targets){
      for(const t of targets){
        // check direct
        if (t in obj && obj[t] !== undefined && obj[t] !== null && String(obj[t]).trim() !== '') return obj[t];
        // check normalized keys
        for(const k of Object.keys(obj)){
          if (norm(k) === t && obj[k] !== undefined && obj[k] !== null && String(obj[k]).trim() !== '') return obj[k];
        }
      }
      return '';
    }

    function renderUnits(units){
      const tbody = document.querySelector('#units tbody');
      const card = document.querySelector('.card');
      tbody.innerHTML = '';
      if (!units || units.length === 0){
        // Oculta la tarjeta/tabla cuando no hay datos (no mostrar filas ni mensaje)
        if (card) card.style.display = 'none';
        return;
      }
      // Asegura que la tarjeta estÃ© visible cuando hay datos
      if (card) card.style.display = '';

      for(const u of units){
        const unidad = u.unidad || getField(u, ['unidad','Unidad','unidad']);
        const economico = (u.economico !== undefined) ? u.economico : getField(u, ['economico','econÃ³mico','EconÃ³mico']);
        const nombreList = u.nombreList || (getField(u,['nombre','Nombre']) ? [getField(u,['nombre','Nombre'])] : []);
        const details = u.details || [];
        const llantasTotal = (typeof u.llantas !== 'undefined') ? u.llantas : (parseFloat(getField(u,['llantas','Llantas'])) || 0);
        const state = (u.state || u.estado || '').toString().toLowerCase() || 'available';

        // Construir HTML para Nombre: si hay varios nombres, mostrar lista desplegable con cada nombre y su cantidad de llantas
        let nameHTML = '';
        if (nombreList.length > 1){
          const listItems = (details.length ? details : nombreList.map(n => ({nombre:n, llantasNum:''}))).map(it => `<li>${it.nombre}${it.llantasNum? ' â€” '+it.llantasNum : ''}</li>`).join('');
          nameHTML = `<details><summary>Ver nombres (${nombreList.length})</summary><ul class="desc-list">${listItems}</ul></details>`;
        } else {
          nameHTML = nombreList[0] || '';
        }

        const llDisplay = Number.isFinite(Number(llantasTotal)) ? (Number(llantasTotal) % 1 === 0 ? String(llantasTotal) : Number(llantasTotal).toFixed(2)) : (llantasTotal || '');

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td data-label="Unidad">${unidad}</td>
          <td data-label="EconÃ³mico">${economico}</td>
          <td data-label="Nombre">${nameHTML}</td>
          <td data-label="Llantas">${llDisplay}</td>
          <td data-label="Estado" class="state ${state}">${state==='confirmed'?'ðŸŸ¢ Confirmado':state==='pending'?'ðŸŸ¡ Pendiente':'âšª Disponible'}</td>
        `;
        tbody.appendChild(tr);
      }
    }

    // Config (editable y guardada en localStorage)
    let SHEETDB_ID = localStorage.getItem('sheetdb_id') || '1bc8voqxnfjwq';
    let USE_SHEETDB = (localStorage.getItem('use_sheetdb') || '1') !== '0';

    async function fetchSheetDB(sheetName){
      try{
        const url = `https://sheetdb.io/api/v1/${SHEETDB_ID}?sheet=${encodeURIComponent(sheetName)}`;
        const r = await fetch(url);
        if (!r.ok) throw new Error(`SheetDB ${r.status}`);
        const json = await r.json();
        if (!Array.isArray(json)) return [];
        return json;
      }catch(e){
        console.warn('SheetDB fetch failed for', sheetName, e);
        return null; // indica fallo
      }
    }

    function arrayValuesToObjects(rows){
      return rows;
    }

    function processAndRender(pendRows, apartRows, sourceLabel){
      const map = new Map();

      function addRowToMap(r, state){
        const id = (getField(r,['unidad','Unidad'])||'').toString().trim();
        if (!id) return;
        const nombre = (getField(r,['nombre','Nombre'])||'').toString().trim();
        const llRaw = (getField(r,['llantas','Llantas'])||'0').toString();
        const llantasNum = parseFloat(llRaw.replace(/[^0-9\.-]/g,'')) || 0;

        const entry = { nombre, llantasNum };

        if (!map.has(id)){
          map.set(id, {
            unidad: id,
            economico: getField(r,['economico','econÃ³mico','EconÃ³mico']) || '',
            nombreList: nombre ? [nombre] : [],
            llantas: llantasNum,
            details: nombre ? [entry] : [],
            state: state
          });
          return;
        }

        const cur = map.get(id);
        if (!cur.economico) cur.economico = getField(r,['economico','econÃ³mico','EconÃ³mico']) || '';
        if (nombre) cur.nombreList.push(nombre);
        cur.llantas = (parseFloat(cur.llantas)||0) + llantasNum;
        if (nombre) cur.details.push(entry);
        if (state === 'confirmed') cur.state = 'confirmed';
      }

      (pendRows||[]).forEach(r => addRowToMap(r, 'pending'));
      (apartRows||[]).forEach(r => addRowToMap(r, 'confirmed'));

      const units = Array.from(map.values()).map(u => ({
        ...u,
        nombreList: Array.from(new Set(u.nombreList))
      }));

      renderUnits(units);
      setBrandStatus(sourceLabel === 'sheetdb' ? '' : sourceLabel);
    }

    async function load(){
      setBrandStatus('Cargando...');
      try{
        if (USE_SHEETDB && SHEETDB_ID){
          const [pRows, aRows] = await Promise.all([
            fetchSheetDB('camiones pendientes'),
            fetchSheetDB('Apartados')
          ]);

          if (pRows === null && aRows === null){
            processAndRender([], [], 'none');
            setBrandStatus('No se pudieron obtener datos (SheetDB fallÃ³)');
            return;
          }

          processAndRender(pRows||[], aRows||[], 'sheetdb');
          return;
        }

        processAndRender([], [], 'none');
        setBrandStatus('No se estÃ¡n usando fuentes externas (sin datos)');
      }catch(e){
        console.error(e);
        setBrandStatus('Error cargando datos: '+ (e.message||e));
      }
    }

    function setBrandStatus(detailMessage){
      const statusEl = document.getElementById('status');
      if (!statusEl) return;
      const logoSrc = 'data:image/jpeg;base64,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';
      const msg = detailMessage ? `<span class="status-msg">${detailMessage}</span>` : '';
      statusEl.innerHTML = `<span class="brand">TRES SIGLOS <img src="${logoSrc}" alt="TRES SIGLOS" class="brand-logo"/></span>${msg}`;
    }

    function setTodayDate(){
      const el = document.getElementById('today');
      if (!el) return;
      const d = new Date();
      el.textContent = d.toLocaleDateString('es-ES', { day: '2-digit', month: 'short', year: 'numeric' });
    }

    setTodayDate();
    load();
  </script>
</body>
</html>
